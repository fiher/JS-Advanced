<!-- JS Advanced Exam @ SoftUni - 13-Nov-2016 -->

<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Add / Remove Towns</title>
    <style>select, input { width: 100px }</style>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
</head>

<body onload="attachEvents()">

<div>Towns</div>
<select id="towns" size="4">
    <option>Sofia</option>
    <option>Varna</option>
    <option>Pleven</option>
</select>

<button id="btnDelete">Delete</button>

<div>
    <input type="text" id="newItem" />
    <button id="btnAdd">Add</button>
</div>

<script>
    function attachEvents() {
        // TODO: â€¦
        let size = 4;
        $('#btnAdd').on('click',function(){
            let town = $('#newItem').val();
            let textVal = document.getElementById("newItem").value;
            if( textVal.match(/\S/)) {
                size++;
                let townSize = document.getElementById("towns");
                townSize.size = size;
                let row = `<option>${town}</option>`;
                $("#towns").append(row);
                document.getElementById("newItem").value = '';
            }
        });
        $('#towns').on('click','option',function(){
            let option = $(this);
            option.attr('selected','true');
        });
        $('#btnDelete').on('click',function(){
            let deleteItem = $('#towns option[selected=true]');
            console.log(deleteItem);
            let remove = document.getElementById("towns");
            remove.remove(remove.selectedIndex);
            //let itemToDelete = deleteItem.toArray()
            //        .map(option => option.textContent).join(',');
            //console.log(deleteItem[0].textContent);
            //WHY IT DOESNOT WORK?
            size--;
            let townSize = document.getElementById("towns");
            townSize.size = size;
        });
    }
</script>
</body>
</html>
